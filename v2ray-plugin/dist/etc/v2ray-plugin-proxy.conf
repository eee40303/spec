#/etc/nginx/conf.d/v2ray-plugin-proxy.conf

server {
    listen       80;

    listen 443 ssl;
    ssl_certificate /etc/path-to-your-ssl-key/fullchain.pem;
    ssl_certificate_key /etc/path-to-your-ssl-key/privkey.pem;
    ssl_session_timeout 60m;
    # ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
    # ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;


    server_name  sub.you-domain.com;
    root /var/www/html/path-to-you-site/html;
    #autoindex on;

    #charset koi8-r;
    #access_log  /var/log/nginx/host.access.log  main;
    access_log off;

    location /favicon.ico {
        log_not_found off;
        access_log off;
    }
    location /robots.txt {
        log_not_found off;
        access_log off;
    }

    location  ^~ /myapp/ {
        if ($scheme = http) {
            return 301 https://$host$request_uri;
        }
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_pass   http://127.0.0.1:12380;
        #proxy_pass   http://[::1]:12380;
        proxy_set_header Host $http_host;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        # intercept errors and response nginx error-page
        proxy_intercept_errors on;
        error_page 400 =404 /404.html;
    }


    #location  ^~ /myapp2/ {
    #    if ($scheme = http) {
    #        return 301 https://$host$request_uri;
    #    }
    #    proxy_redirect off;
    #    proxy_http_version 1.1;
    #    proxy_pass   http://127.0.0.1:12380;
    #    #proxy_pass   http://[::1]:12380;
    #    proxy_set_header Host $http_host;
    #    proxy_set_header Upgrade $http_upgrade;
    #    proxy_set_header Connection "upgrade";
    #    # intercept errors and response nginx error-page
    #    proxy_intercept_errors on;
    #    error_page 400 =404 /404.html;
    #}

}

